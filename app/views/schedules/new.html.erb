<%= render 'activities/header' %>


<div class="mdl-card mdl-shadow--2dp">
  <div class="mdl-card__title">
    <h2 class="mdl-card__title-text">Nuovo Orario per l'attivita'</h2>
  </div>


  <div class="mdl-card__supporting-text">

    <% case @activity.a_type %>
      <% when 0 %>

        <%= form_for(setup_planning(@planning)) do |f| %>

            <% f.fields_for :schedules do |ff| %>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                  <%= f.text_field :time, class: 'mdl-textfield__input', pattern: '^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$' %>
                  <%= f.label :time, "Ora #{i}", class: 'mdl-textfield__label' %>
                  <span class="mdl-textfield__error">Ora nel formato 24h e HH:mm</span>
                </div>
            <% end %>

            <div>
              <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" type="submit">
                <i class="material-icons">add</i> &nbsp Aggiungi PIANIFICAZIONE all'attivita'
              </button>
            </div>
        <% end %>

      <% else %>



        <div class="specify_weekly_schedule"><br>

          <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="specify_date">
            <input type="radio" id="specify_date" name="schedule_date" class="mdl-radio__button" data-by-date="true">
            <span class="mdl-radio__label">Specifica Orari come DATE</span>
          </label>
        </div>

        <div class="specify_weekly_schedule"><br>
          <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="specify_day">
            <input type="radio" id="specify_day" name="schedule_day" class="mdl-radio__button" data-by-day="true">
            <span class="mdl-radio__label">Specifica Orari come GIORNI</span>
          </label>
        </div>

        <br>
        <div class="weekly-schedules-forms">
          <div class="weekly-schedule-form">
            <div id="weekly-schedules-by-date">

              <%= form_tag schedules_path(:planning_id => @planning_id), method: 'post' do |form| %>
                <br>Devi inserire esattamante <%= @schedules.length %> ORARI di tipo DATA/GIORNO, visto che l'attivita' <br>
                presa in considerazione e' un'attivita' SETTIMANALE da fare <%= @activity.n_times %> volte a settimana. <br>
                <% @schedules.each_with_index do |schedule, i| %>
                      <%= fields_for 'schedules[]', schedule do |f| %>
                        <div>
                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                            <%= f.text_field :date, class: 'mdl-textfield__input',
                                             pattern: '^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$' %>
                            <%= f.label :date, "Data #{i}", class: 'mdl-textfield__label' %>
                            <span class="mdl-textfield__error">Data nella forma GG/MM/AAAA oppure GG.MM.AAA oppure GG-MM-AAAA</span>
                          </div>

                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                            <%= f.text_field :time, class: 'mdl-textfield__input',
                                             pattern: '^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$' %>
                            <%= f.label :time, "Ora #{i}", class: 'mdl-textfield__label' %>
                            <span class="mdl-textfield__error">Ora nel formato 24h e HH:mm</span>
                          </div>
                        </div>

                    <% end %>
                <% end %>

                <div>
                  <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" type="submit">
                    <i class="material-icons">add</i> &nbsp Aggiungi PIANIFICAZIONE all'attivita'
                  </button>
                </div>

              <% end %>

            </div>

            <div id="weekly-schedules-by-day">

              <%= form_tag schedules_path(:planning_id => @planning_id), method: 'post' do |form| %>
                  <% days_of_week = [['', ''], ['Lunedi\'', 0], ['Martedi\'', 1],['Mercoledi\'', 2],
                                     ['Giovedi\'', 3],['Venerdi\'', 4],['Sabato', 5],['Domenica', 6]] %>

                <br>Devi inserire esattamante <%= @schedules.length %> ORARI di tipo DATA/GIORNO, visto che l'attivita' <br>
                presa in considerazione e' un'attivita' SETTIMANALE da fare <%= @activity.n_times %> volte a settimana. <br>
                <% @schedules.each_with_index do |schedule, i| %>
                    <%= fields_for 'schedules[]', schedule do |f| %>
                      <div>
                        <div class="mdl-selectfield mdl-js-selectfield mdl-selectfield--floating-label">
                          <%= f.select :day, options_for_select(days_of_week), {}, {class: 'mdl-selectfield__select'} %>
                          <div class="mdl-selectfield__icon"><i class="material-icons">arrow_drop_down</i></div>
                          <label class="mdl-selectfield__label" for="professsion">Giorno <%= i %></label>
                        </div>

                        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                          <%= f.text_field :time, class: 'mdl-textfield__input',
                                           pattern: '^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$' %>
                          <%= f.label :time, 'Ora', class: 'mdl-textfield__label' %>
                          <span class="mdl-textfield__error">Ora nel formato 24h e HH:mm</span>
                        </div>
                      </div>
                    <% end %>
                <% end %>

                <div>
                  <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" type="submit">
                    <i class="material-icons">add</i> &nbsp Aggiungi PIANIFICAZIONE all'attivita'
                  </button>
                </div>

              <% end %>

            </div>

          </div>

        </div>

    <% end %>
  </div>
</div>
